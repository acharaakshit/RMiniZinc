<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Akshit Achara, Lars Kotthoff, Hans W. Borchers, Guido Tack" />


<title>MiniZinc Interface for R</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MiniZinc Interface for R</h1>
<h4 class="author">Akshit Achara, Lars Kotthoff, Hans W. Borchers, Guido Tack</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>MiniZinc is a free and open-source constraint modeling language. Constraint satisfaction and discrete optimization problems can be formulated in a high-level modeling language. Models are compiled into an intermediate representation that is understood by a wide range of solvers. MiniZinc itself provides several solvers, for instance GeCode. The existing packages in R are not powerful enough to solve even mid-sized problems in combinatorial optimization.</p>
<p>There are implementations of an Interface to MiniZinc in Python like MiniZinc Python and pymzn and JMiniZinc for Java but such an interface does not exist for R.</p>
<p>This package provides an implementation of a very simple and easy to use interface for R that will help R users to solve optimization problems that couldn’t be solved with R till now.</p>
<p>It’s important to understand R6 classes before getting into the details. If you are not comfortable with R6, please go through this tutorial.</p>
<p>It would be nice to go through the tutorials on the MiniZinc website to understand more about MiniZinc. This is mainly for those who are interested in contributing to the package.</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<ol style="list-style-type: decimal">
<li>Build libminizinc</li>
</ol>
<p>First, You need to download the latest libminizinc release and build libminizinc library for MiniZinc to work properly.</p>
<p>Please follow these steps for Linux:</p>
<ul>
<li>Download the latest libminizinc release from <a href="https://github.com/MiniZinc/libminizinc/releases" class="uri">https://github.com/MiniZinc/libminizinc/releases</a>.</li>
<li>Extract the downloaded tar.gz or zip (for Windows) and name the extracted folder <code>libminizinc</code>.</li>
<li><code>cd libminizinc/</code><br />
</li>
<li><code>sudo sed -i &#39;3 i set(CMAKE_POSITION_INDEPENDENT_CODE ON)&#39; CMakeLists.txt</code><br />
</li>
<li><code>sudo cmake CMakeLists.txt</code><br />
</li>
<li><code>sudo make</code><br />
</li>
<li><code>sudo make install</code></li>
</ul>
<p>Similarly, build libminizinc on Windows (can use cygwin) and OSX.</p>
<p>If <code>sed</code> command doesn’t work for you, just add <code>set(CMAKE_POSITION_INDEPENDENT_CODE ON)</code> in the 3rd line (or any empty line in the starting) of CMakeLists.txt and follow the next steps.</p>
<ol start="2" style="list-style-type: decimal">
<li>Get Solver Binaries</li>
</ol>
<p>Solvers are required to solve the MiniZinc models. The solvers currently supported by rminizinc are Chuffed, FindMUS and Gecode. Any solver can be selected based on the type of problem that is required to be solved.</p>
<p>Now download the solver binaries from the binary bundles at (<a href="https://www.minizinc.org/" class="uri">https://www.minizinc.org/</a>) to be able to solve the models and achieve full functionality of the package.</p>
<p>To get the solver binaries, the Users can download the MiniZinc binary bundles for Windows, MAC OS or Linux from <a href="https://www.minizinc.org/software.html" class="uri">https://www.minizinc.org/software.html</a> and the provide the path to the bin folder of the MiniZinc bundle folder as the <code>--with-bin</code> argument. All the required solver binaries are present in that folder. The solver binary corresponding to Gecode will be <code>fzn-gecode</code>, FindMUS will be <code>findMUS</code>, Chuffed will be <code>fzn-chuffed</code> (.exe extentions will be there on Windows for eg. <code>fzn-gecode.exe</code>). Alternatively, if you don’t want to keep the MiniZinc bundle, you can copy the solver binaries to another folder and just provide the path to that folder with <code>--with-bin</code>.</p>
<p>Once these steps are over, you just need to re-install rminizinc by using</p>
<p><code>install.packages(&quot;rminizinc&quot;, configure.args=&quot;--with-mzn=/path/to/libminizinc --with-bin=/path/to/bin&quot;)</code></p>
<p>NOTE: Please don’t use <code>\</code> at the end of the path given to <code>--with-bin</code> as it will cause some solver configuration issues.</p>
<p>Please note that if path arguments are not passed along with the installation (as <code>--with-mzn</code>), the default path <code>/usr/local/lib</code> for Linux and OSX, and <code>C:/Program Files/</code> for Windows will be chosen but only if libminizinc in present in these default paths.</p>
</div>
<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<p>Load the library and the project root directory path</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(rminizinc)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># load the PROJECT_DIRECTORY</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">data</span>(<span class="st">&quot;proot&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># check if the library is present</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">data</span>(<span class="st">&quot;config&quot;</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>parse.next =<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="cf">if</span>(LIBMINIZINC_PATH <span class="op">==</span><span class="st"> &quot;&quot;</span>){</span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="kw">warning</span>(<span class="st">&quot;Please install libminizinc on your system!&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>  parse.next =<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>}</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># check if solver binaries are present</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="kw">data</span>(<span class="st">&quot;slvbin&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a>evaluate.next =<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="cf">if</span>(SOLVER_BIN <span class="op">==</span><span class="st"> &quot;&quot;</span>){</span>
<span id="cb1-17"><a href="#cb1-17"></a>  <span class="kw">warning</span>(<span class="st">&quot;Please download solver binaries to solve the model&quot;</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a>  evaluate.next =<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>}</span></code></pre></div>
<pre><code>## Warning: Please download solver binaries to solve the model</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># check if vignettes should be executed</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;rmarkdown&quot;</span>) <span class="op">||</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="op">!</span>rmarkdown<span class="op">::</span><span class="kw">pandoc_available</span>(<span class="st">&quot;1.14&quot;</span>)) {</span>
<span id="cb3-4"><a href="#cb3-4"></a>     <span class="kw">warning</span>(<span class="dt">call. =</span> <span class="ot">FALSE</span>, <span class="st">&quot;This vignette assumes that rmarkdown and pandoc</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="st">version 1.14 are available. These were not found. Older versions will not work.&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>     knitr<span class="op">::</span><span class="kw">knit_exit</span>()</span>
<span id="cb3-7"><a href="#cb3-7"></a>   }</span></code></pre></div>
</div>
<div id="some-common-cp-problems" class="section level2">
<h2>Some Common CP Problems</h2>
<p>Functions have been provided to directly solve some of the common constraint programming problems.</p>
<ol style="list-style-type: decimal">
<li>Knapsack problem</li>
</ol>
<p>The knapsack problem is a problem in combinatorial optimization: Given a set of items, each with a weight and a value, determine the number of each item to include in a collection so that the total weight is less than or equal to a given limit and the total value is as large as possible. It derives its name from the problem faced by someone who is constrained by a fixed-size knapsack and must fill it with the most valuable items. The problem often arises in resource allocation where the decision makers have to choose from a set of non-divisible projects or tasks under a fixed budget or time constraint, respectively.</p>
<p>Here, n is the number of items, capacity is the total capacity of carrying weight, profit is the profit corresponding to each item and weight is the weight/size of each item. The goal is to maximize the total profit.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># knapsack problem</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>result =<span class="st"> </span><span class="kw">knapsack</span>(<span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">capacity =</span> <span class="dv">9</span>, <span class="dt">profit =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">10</span>,<span class="dv">7</span>), <span class="dt">size =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;The minizinc representation of the problem is:</span><span class="ch">\n</span><span class="st">%s&quot;</span>, result<span class="op">$</span>model<span class="op">$</span><span class="kw">mzn_string</span>()))</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;The solutions returned by minizinc are:</span><span class="ch">\n</span><span class="st">%s&quot;</span>, result<span class="op">$</span>solution<span class="op">$</span>SOLUTION_STRING))</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># R representation of solutions</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">print</span>(result<span class="op">$</span>solution<span class="op">$</span>SOLUTIONS)</span></code></pre></div>
<pre><code>## The minizinc representation of the problem is:
## int: n = 3;
## 
## set of int: OBJ = (1 .. n);
## 
## int: capacity = 9;
## 
## array[OBJ] of int: profit = [15, 10, 7];
## 
## array[OBJ] of int: size = [4, 3, 2];
## 
## array[OBJ] of var int: x;
## 
## constraint forall([(x[i] &gt;= 0) | i in OBJ ]);
## 
## constraint (sum([(size[i] * x[i]) | i in OBJ ]) &lt;= capacity);
## 
## solve  maximize sum([(profit[i] * x[i]) | i in OBJ ]);
## 
## include &quot;solver_redefinitions.mzn&quot;;
## 
## include &quot;stdlib.mzn&quot;;
## 
## The solutions returned by minizinc are:
## {
##   &quot;x&quot; : [0, 0, 0]
## }
## ----------
## {
##   &quot;x&quot; : [0, 0, 1]
## }
## ----------
## {
##   &quot;x&quot; : [0, 0, 2]
## }
## ----------
## {
##   &quot;x&quot; : [0, 0, 3]
## }
## ----------
## {
##   &quot;x&quot; : [0, 0, 4]
## }
## ----------
## {
##   &quot;x&quot; : [0, 1, 3]
## }
## ----------
## {
##   &quot;x&quot; : [1, 1, 1]
## }
## ----------
## ==========
## $SOLUTION0
## $SOLUTION0$x
## [1] 0 0 0
## 
## 
## $SOLUTION1
## $SOLUTION1$x
## [1] 0 0 1
## 
## 
## $SOLUTION2
## $SOLUTION2$x
## [1] 0 0 2
## 
## 
## $SOLUTION3
## $SOLUTION3$x
## [1] 0 0 3
## 
## 
## $SOLUTION4
## $SOLUTION4$x
## [1] 0 0 4
## 
## 
## $SOLUTION5
## $SOLUTION5$x
## [1] 0 1 3
## 
## 
## $OPTIMAL_SOLUTION
## $OPTIMAL_SOLUTION$x
## [1] 1 1 1</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Assignment problem</li>
</ol>
<p>The assignment problem is a fundamental combinatorial optimization problem. In its most general form, the problem is as follows:</p>
<p>The problem instance has a number of agents and a number of tasks. Any agent can be assigned to perform any task, incurring some cost that may vary depending on the agent-task assignment. It is required to perform as many tasks as possible by assigning at most one agent to each task and at most one task to each agent, in such a way that the total cost of the assignment is minimized.</p>
<p>Here, n is the number of agents, m is the number of tasks and the profit(cost) is an m x n 2D array where each row corresponds to the cost of each task for that agent. Please provide the profit array as a 1D vector only as shown below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># assignment problem</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>result  =<span class="st"> </span><span class="kw">assignment</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">m =</span> <span class="dv">5</span>, <span class="dt">cost =</span> <span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">6</span>))</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;The minizinc representation of the problem is:</span><span class="ch">\n</span><span class="st">%s&quot;</span>, result<span class="op">$</span>model<span class="op">$</span><span class="kw">mzn_string</span>()))</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;The solutions returned by minizinc are:</span><span class="ch">\n</span><span class="st">%s&quot;</span>, result<span class="op">$</span>solution<span class="op">$</span>SOLUTION_STRING))</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># R representation of solutions</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">print</span>(result<span class="op">$</span>solution<span class="op">$</span>SOLUTIONS)</span></code></pre></div>
<pre><code>## The minizinc representation of the problem is:
## int: n = 4;
## 
## set of int: DOM = (1 .. n);
## 
## int: m = 5;
## 
## set of int: COD = (1 .. m);
## 
## array[DOM, COD] of int: cost = [|7, 1, 3, 4, 6,
## |8, 2, 5, 1, 4,
## |4, 3, 7, 2, 5,
## |3, 1, 6, 3, 6
## |];
## 
## array[DOM] of var COD: task;
## 
## constraint alldifferent(task);
## 
## solve  minimize sum([cost[w, task[w]] | w in DOM ]);
## 
## include &quot;solver_redefinitions.mzn&quot;;
## 
## include &quot;stdlib.mzn&quot;;
## 
## include &quot;alldifferent.mzn&quot;;
## 
## The solutions returned by minizinc are:
## {
##   &quot;task&quot; : [4, 3, 2, 1]
## }
## ----------
## {
##   &quot;task&quot; : [3, 4, 2, 1]
## }
## ----------
## {
##   &quot;task&quot; : [3, 4, 1, 2]
## }
## ----------
## ==========
## $SOLUTION0
## $SOLUTION0$task
## [1] 4 3 2 1
## 
## 
## $SOLUTION1
## $SOLUTION1$task
## [1] 3 4 2 1
## 
## 
## $OPTIMAL_SOLUTION
## $OPTIMAL_SOLUTION$task
## [1] 3 4 1 2</code></pre>
<p>Some other problem specific functions that are available are <code>magic_series()</code>, <code>magic_square()</code>, <code>assignment_2()</code>, and <code>production_planning()</code>. More problems will be added with version updates.</p>
</div>
<div id="parse-a-minizinc-model" class="section level2">
<h2>Parse a MiniZinc Model</h2>
<p>A parser function <code>mzn_parse</code> has been implemented which can be used to detect possible syntax errors and get the smallest of details before the MiniZinc model is evaluated. The function returns the initialize <code>Model</code> R6 object.</p>
<p>Now, let’s solve a knapsack model:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># mzn file path</span></span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># load the PROJECT_DIRECTORY</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">data</span>(<span class="st">&quot;proot&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="st">&quot;</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="st">NOTE: PROJECT_DIRECTORY is the project root directory path. This path is used for pointing to the mzn files provided with the package. If you have installed the package, PROJECT_DIRECTORY will initially point to tmp as the R package installation starts there. However, the next chunk of code will detect that and point to the installed rminizinc root folder. If you have installed rminizinc in some other location please make the PROJECT_DIRECTORY point to that folder.</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="st">&quot;</span></span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a>mzn_local_location =<span class="st"> &quot;/inst/extdata/mzn_examples/&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="cf">if</span>(<span class="kw">grepl</span>( <span class="st">&quot;tmp&quot;</span>, PROJECT_DIRECTORY, <span class="dt">fixed =</span> <span class="ot">TRUE</span>)){</span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="kw">message</span>(<span class="st">&quot;PROJECT_DIRECTORY is not a correct location anymore. Now PROJECT_DIRECTORY</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="st">          is pointing to the location of installed rminizinc package. Please note that</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="st">          the PROJECT_DIRECTORY stored in proot.RData is still the &quot;</span>)</span>
<span id="cb8-16"><a href="#cb8-16"></a>  PROJECT_DIRECTORY =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">.libPaths</span>()[<span class="dv">1</span>], <span class="st">&quot;/rminizinc&quot;</span>)</span>
<span id="cb8-17"><a href="#cb8-17"></a>  mzn_local_location =<span class="st"> &quot;/extdata/mzn_examples/&quot;</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>}</span>
<span id="cb8-19"><a href="#cb8-19"></a></span>
<span id="cb8-20"><a href="#cb8-20"></a>mzn_path =<span class="st"> </span><span class="kw">paste0</span>(PROJECT_DIRECTORY, mzn_local_location, <span class="st">&quot;knapsack/knapsack_0.mzn&quot;</span>)</span>
<span id="cb8-21"><a href="#cb8-21"></a></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co"># returns the R equivalent of a MiniZinc model</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>parsedModel =<span class="st"> </span>rminizinc<span class="op">:::</span><span class="kw">mzn_parse</span>(<span class="dt">mzn_path =</span> mzn_path)</span>
<span id="cb8-24"><a href="#cb8-24"></a></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;The current model is:</span><span class="ch">\n</span><span class="st">%s&quot;</span>, parsedModel<span class="op">$</span><span class="kw">mzn_string</span>()))</span></code></pre></div>
<pre><code>## [1] &quot;\nNOTE: PROJECT_DIRECTORY is the project root directory path. This path is used for pointing to the mzn files provided with the package. If you have installed the package, PROJECT_DIRECTORY will initially point to tmp as the R package installation starts there. However, the next chunk of code will detect that and point to the installed rminizinc root folder. If you have installed rminizinc in some other location please make the PROJECT_DIRECTORY point to that folder.\n&quot;
## The current model is:
## int: n;
## 
## set of int: OBJ = (1 .. n);
## 
## int: capacity;
## 
## array[OBJ] of int: profit;
## 
## array[OBJ] of int: size;
## 
## array[OBJ] of var int: x;
## 
## constraint forall([(x[i] &gt;= 0) | i in OBJ ]);
## 
## constraint (sum([(size[i] * x[i]) | i in OBJ ]) &lt;= capacity);
## 
## solve  maximize sum([(profit[i] * x[i]) | i in OBJ ]);
## 
## include &quot;solver_redefinitions.mzn&quot;;
## 
## include &quot;stdlib.mzn&quot;;</code></pre>
<p>Look at the contents of parseObj for more understanding of the model.</p>
</div>
<div id="find-the-missing-parameters" class="section level2">
<h2>Find the Missing Parameters</h2>
<p>The missing parameters can be obtained using <code>get_missing_pars()</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>missingPars =<span class="st"> </span><span class="kw">get_missing_pars</span>(<span class="dt">model =</span> parsedModel)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">print</span>(missingPars)</span></code></pre></div>
<pre><code>## [1] &quot;n&quot;        &quot;capacity&quot; &quot;profit&quot;   &quot;size&quot;</code></pre>
</div>
<div id="set-values-of-missing-parameters" class="section level2">
<h2>Set Values of Missing Parameters</h2>
<p>The missing parameters can be directly provided a value instead of using a data (dzn) file to solve. The values can be provided as a named list of the parameters. The data will be entered according to the data file as shown below:</p>
<pre><code>n = 3;
capacity = 9;
profit = [15,10,7];
size = [4,3,2];</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Int$new() for creating a new integer in model</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># Array$new() for creating an array</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># intExpressions() to create a sequence of integers (useful for array)</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>pVals =<span class="st"> </span><span class="kw">list</span>(Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">3</span>), Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">9</span>), Array<span class="op">$</span><span class="kw">new</span>(<span class="kw">c</span>(Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">15</span>), Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">10</span>), Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">7</span>)),</span>
<span id="cb13-5"><a href="#cb13-5"></a>                                               <span class="dt">dimranges =</span> <span class="kw">c</span>(IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dv">1</span>, <span class="dv">3</span>))),</span>
<span id="cb13-6"><a href="#cb13-6"></a>            Array<span class="op">$</span><span class="kw">new</span>(<span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>)), <span class="dt">dimranges =</span> <span class="kw">c</span>(IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dv">1</span>, <span class="dv">3</span>))))</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="kw">names</span>(pVals) =<span class="st"> </span>missingPars</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a>model =<span class="st"> </span><span class="kw">set_params</span>(<span class="dt">model =</span> parsedModel, <span class="dt">modData =</span> pVals)</span>
<span id="cb13-11"><a href="#cb13-11"></a></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co"># check ?Model for more details</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;The updated model is:</span><span class="ch">\n</span><span class="st"> %s&quot;</span>, model<span class="op">$</span><span class="kw">mzn_string</span>()))</span></code></pre></div>
<pre><code>## The updated model is:
##  int: n = 3;
## 
## set of int: OBJ = (1 .. n);
## 
## int: capacity = 9;
## 
## array[OBJ] of int: profit = [15, 10, 7];
## 
## array[OBJ] of int: size = [4, 3, 2];
## 
## array[OBJ] of var int: x;
## 
## constraint forall([(x[i] &gt;= 0) | i in OBJ ]);
## 
## constraint (sum([(size[i] * x[i]) | i in OBJ ]) &lt;= capacity);
## 
## solve  maximize sum([(profit[i] * x[i]) | i in OBJ ]);
## 
## include &quot;solver_redefinitions.mzn&quot;;
## 
## include &quot;stdlib.mzn&quot;;</code></pre>
</div>
<div id="solve-the-model" class="section level2">
<h2>Solve the Model</h2>
<p>The function <code>mzn_eval()</code> is used to evaluate a MiniZinc model and returns the solution string and a list of solutions if they were parsed without any error by the function <code>sol_parse()</code> otherwise it returns the solution string and an appropriate error. The parsed solutions are a named list where elements are of type <code>OBJ$SOLUTIONS$SOLUTION&lt;n&gt;$&lt;VARIABLE_NAME&gt;</code>. The optimal solution if found can be accessed using <code>OBJ$SOLUTIONS$OPTIMAL_SOLUTION</code> and the best solution can be accessed using <code>OBJ$SOLUTIONS$BEST_SOLUTION</code>. More details about the functions can be obtained using <code>?mzn_eval</code> and <code>?sol_parse</code>.</p>
<p>The solver name of the solver that should be used to solve the model needs to be specified by the user (default is “Gecode”) and the <code>lib_path</code> (path of the solver configuration files) is by default provided but a custom path can be provided the user in case it is required. The model must be provided as one and only one of R6 <code>Model</code> object, <code>mzn_path</code> i.e. path of mzn file or <code>model_string</code> i.e. the string representation of the model. If the user wishes to provide a data file, it’s path can be provided to the argument <code>dznpath</code>. A time limit (in ms) can also be provided to the argument <code>time_limit</code>. (default is 300000 ms)</p>
<p>A sample knapsack problem has been solved below::</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># R List object containing the solutions</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>solObj =<span class="st"> </span>rminizinc<span class="op">:::</span><span class="kw">mzn_eval</span>(<span class="dt">r_model =</span> model)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># get all the solutions</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="kw">print</span>(solObj<span class="op">$</span>SOLUTIONS)</span></code></pre></div>
<pre><code>## $SOLUTION0
## $SOLUTION0$x
## [1] 0 0 0
## 
## 
## $SOLUTION1
## $SOLUTION1$x
## [1] 0 0 1
## 
## 
## $SOLUTION2
## $SOLUTION2$x
## [1] 0 0 2
## 
## 
## $SOLUTION3
## $SOLUTION3$x
## [1] 0 0 3
## 
## 
## $SOLUTION4
## $SOLUTION4$x
## [1] 0 0 4
## 
## 
## $SOLUTION5
## $SOLUTION5$x
## [1] 0 1 3
## 
## 
## $OPTIMAL_SOLUTION
## $OPTIMAL_SOLUTION$x
## [1] 1 1 1</code></pre>
<p>The above example is taken from <a href="https://github.com/MiniZinc/minizinc-examples">minizinc-examples</a>.</p>
<p>NOTE: The output formatting in the mzn files will be automatically removed in the parsed R model.</p>
</div>
<div id="items" class="section level2">
<h2>Items</h2>
<p>A MiniZinc model is made of several items namely, Variables, Constraints, Solve Items, Assignments,etc. which are described below.</p>
<div id="variables" class="section level3">
<h3>Variables</h3>
<p>There are two types of variables in MiniZinc namely, decision variables and parameters.</p>
<p>The data types of variables can be single types i.e integers (int), floating point numbers (float), Booleans (bool) and strings (string) and collections i.e sets, enums and arrays (upto 6 dimensional arrays).</p>
<p>Parameter is used to specify a parameter in a given problem and they are assigned a fixed value or expression.</p>
<p>Decision variables are the unknowns that Minizinc model is finding solutions for. We do not need to give them a value, but instead we give them a domain of possible values. Sometimes expressions involving other variables and parameters are also assigned to decision variables. Decision variables need to satisfy a set of constraints which form the core of the problem.</p>
<p>To create a variable declaration one needs to understand the elements of R6 classes that will be used to create the variables.</p>
<p>Easy to use declaration functions have been created for the users to declare variables and parameters of different data types. Some examples of how to declare variables is shown below.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># int: a;</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>a =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>))</span>
<span id="cb17-3"><a href="#cb17-3"></a>a<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;int: a;\n&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># var int: a;</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>a =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;var&quot;</span>))</span>
<span id="cb19-3"><a href="#cb19-3"></a>a<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;var int: a;\n&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># 0..3: a;</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>a =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3"></a>                                   <span class="dt">domain =</span> Set<span class="op">$</span><span class="kw">new</span>(IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dt">imin =</span> <span class="dv">0</span>, <span class="dt">imax =</span> <span class="dv">3</span>))))</span>
<span id="cb21-4"><a href="#cb21-4"></a>a<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;0..3: a;\n&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># set of int: b = 1..5;</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>b =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntSetDecl</span>(<span class="dt">name =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, </span>
<span id="cb23-3"><a href="#cb23-3"></a>                                      <span class="dt">value =</span> Set<span class="op">$</span><span class="kw">new</span>(IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dt">imin =</span> <span class="dv">1</span>, <span class="dt">imax =</span> <span class="dv">5</span>))))</span>
<span id="cb23-4"><a href="#cb23-4"></a>b<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;set of int: b = 1..5;\n&quot;</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># set of int: b = {1, 3, 5, 7, 9};</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>b =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntSetDecl</span>(<span class="dt">name =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, </span>
<span id="cb25-3"><a href="#cb25-3"></a>                                      <span class="dt">value =</span> Set<span class="op">$</span><span class="kw">new</span>(<span class="dt">val =</span> <span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span> ,<span class="dv">7</span> ,<span class="dv">9</span>)))))</span>
<span id="cb25-4"><a href="#cb25-4"></a>b<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;set of int: b = {1, 3, 5, 7, 9};\n&quot;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># int: IND = 3;</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>a =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;IND&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, <span class="dt">value =</span> <span class="dv">3</span>))</span>
<span id="cb27-3"><a href="#cb27-3"></a>a<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;int: IND = 3;\n&quot;</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>val =<span class="st"> </span>a<span class="op">$</span><span class="kw">getDecl</span>()<span class="op">$</span><span class="kw">getValue</span>()<span class="op">$</span><span class="kw">getIntVal</span>()</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">sprintf</span>(<span class="st">&quot;The value of a is: %s&quot;</span>, val)</span></code></pre></div>
<pre><code>## [1] &quot;The value of a is: 3&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># array[IND] of int: p = [15,10,7];</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>p =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntArrDecl</span>(<span class="dt">name =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, <span class="dt">ind =</span> <span class="kw">c</span>(a<span class="op">$</span><span class="kw">getId</span>()),</span>
<span id="cb31-3"><a href="#cb31-3"></a>                                  <span class="dt">value =</span> Array<span class="op">$</span><span class="kw">new</span>(<span class="dt">exprVec =</span> <span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">7</span>)),</span>
<span id="cb31-4"><a href="#cb31-4"></a>                                                    <span class="dt">dimranges =</span> <span class="kw">c</span>(IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dv">1</span>, val))),</span>
<span id="cb31-5"><a href="#cb31-5"></a>                                        <span class="dt">ndim =</span> <span class="dv">1</span>))</span>
<span id="cb31-6"><a href="#cb31-6"></a>p<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;array[IND] of int: p = [15, 10, 7];\n&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># array[IND] of int: p = [|1, 2, 3 | 4, 5, 6 | 7, 8, 9|];</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co"># Array can only be used to provide 1D and 2D array values</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>array_value =<span class="st"> </span>Array<span class="op">$</span><span class="kw">new</span>(<span class="dt">exprVec =</span> <span class="kw">c</span>(<span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)), <span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)),                                                                    <span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>))),</span>
<span id="cb33-4"><a href="#cb33-4"></a>                                        <span class="dt">dimranges =</span> <span class="kw">c</span>(IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dv">1</span>, val), IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dv">1</span>, val)))</span>
<span id="cb33-5"><a href="#cb33-5"></a>p =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntArrDecl</span>(<span class="dt">name =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, <span class="dt">ind =</span> <span class="kw">c</span>(a<span class="op">$</span><span class="kw">getId</span>(), a<span class="op">$</span><span class="kw">getId</span>()),</span>
<span id="cb33-6"><a href="#cb33-6"></a>                    <span class="dt">value =</span> array_value, <span class="dt">ndim =</span> <span class="dv">2</span>))</span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="kw">cat</span>(p<span class="op">$</span><span class="kw">c_str</span>())</span></code></pre></div>
<pre><code>## array[IND, IND] of int: p = [|1, 2, 3,
## |4, 5, 6,
## |7, 8, 9
## |];</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co">## Recommended way to provide array values</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>array_value =<span class="st"> </span>Call<span class="op">$</span><span class="kw">new</span>(<span class="dt">fnName =</span> <span class="st">&quot;array2d&quot;</span>, <span class="dt">args =</span> <span class="kw">c</span>(a<span class="op">$</span><span class="kw">getId</span>(), a<span class="op">$</span><span class="kw">getId</span>(),</span>
<span id="cb35-3"><a href="#cb35-3"></a>                                                    <span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)), <span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)),                                                                    <span class="kw">intExpressions</span>(<span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>))))</span>
<span id="cb35-4"><a href="#cb35-4"></a>p<span class="op">$</span><span class="kw">getDecl</span>()<span class="op">$</span><span class="kw">setValue</span>(array_value)</span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="kw">cat</span>(p<span class="op">$</span><span class="kw">c_str</span>())</span></code></pre></div>
<pre><code>## array[IND, IND] of int: p = array2d(IND, IND, 1, 2, 3, 4, 5, 6, 7, 8, 9);</code></pre>
</div>
<div id="constraints" class="section level3">
<h3>Constraints</h3>
<p>Constraints are defined on the decision variables to restrict the range of values that they can take. They can also be thought of as the rules of a problem.</p>
<p>Constraints can be created using the R6 class ConstraintItem. More information can be found using ?<class Name></p>
<p>Create constraints:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># var int a; constraint a &lt; 10;</span></span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co"># var int a;</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>a =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;var&quot;</span>))</span>
<span id="cb37-5"><a href="#cb37-5"></a>a<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;var int: a;\n&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># a &lt; 10;</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>exp =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> a<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">binop =</span> <span class="st">&quot;&lt;&quot;</span>, <span class="dt">rhs =</span> Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">10</span>))</span>
<span id="cb39-3"><a href="#cb39-3"></a>exp<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;(a &lt; 10)&quot;</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># constraint a &lt; 10;</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>cnst =<span class="st"> </span>ConstraintItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">e =</span> exp)</span>
<span id="cb41-3"><a href="#cb41-3"></a>cnst<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;constraint (a &lt; 10);\n&quot;</code></pre>
</div>
<div id="solve-types" class="section level3">
<h3>Solve Types</h3>
<p>The constraint programming problem can be of three types, namely: satisfy (satisfaction) , minimize (minimization) and maximize (maximization). Satisfaction problems produce all the solutions that satisfy the constraints whereas minimization and maximization problems produce the solution which minimizes and maximizes the given expression.</p>
<p>An example is shown below:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># solve satisfy;</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>s =<span class="st"> </span>SolveItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">solve_type =</span> <span class="st">&quot;satisfy&quot;</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a>s<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;solve  satisfy;\n&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># var int: sum; </span></span>
<span id="cb45-2"><a href="#cb45-2"></a>sum =<span class="st"> </span><span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;var&quot;</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a>sum<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;var int: sum&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># minimize sum;</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>s =<span class="st"> </span>SolveItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">solve_type =</span> <span class="st">&quot;minimize&quot;</span>, <span class="dt">e =</span> sum<span class="op">$</span><span class="kw">getId</span>())</span>
<span id="cb47-3"><a href="#cb47-3"></a>s<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;solve  minimize sum;\n&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># maximize sum;</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>s =<span class="st"> </span>SolveItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">solve_type =</span> <span class="st">&quot;maximize&quot;</span>, <span class="dt">e =</span> sum<span class="op">$</span><span class="kw">getId</span>())</span>
<span id="cb49-3"><a href="#cb49-3"></a>s<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;solve  maximize sum;\n&quot;</code></pre>
</div>
</div>
<div id="expressions" class="section level2">
<h2>Expressions</h2>
<p>Given below are some examples of commonly used MiniZinc expressions. Check examples of some other expressions in the <a href="https://cran.r-project.org/web/packages/rminizinc/rminizinc.pdf">reference manual</a>.</p>
<div id="comprehension" class="section level3">
<h3>Comprehension</h3>
<p>Read more about comprehensions <a href="https://www.minizinc.org/doc-2.4.3/en/spec.html#spec-set-comprehensions">here</a>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># always provide ind (array index) in c() or list()</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>a =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> <span class="kw">IntArrDecl</span>(<span class="dt">name =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;var&quot;</span>,<span class="dt">ind =</span> <span class="kw">c</span>(Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">4</span>)),<span class="dt">ndim =</span> <span class="dv">1</span>))</span>
<span id="cb51-3"><a href="#cb51-3"></a>a<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;array[4] of var int: a;\n&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>iter =<span class="st"> </span><span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;i&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>generator =<span class="st"> </span>Generator<span class="op">$</span><span class="kw">new</span>(<span class="dt">IN =</span> a<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">decls =</span> <span class="kw">list</span>(iter))</span>
<span id="cb53-3"><a href="#cb53-3"></a>bop =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> ArrayAccess<span class="op">$</span><span class="kw">new</span>(<span class="dt">v =</span> a<span class="op">$</span><span class="kw">getId</span>(),  <span class="dt">args=</span> <span class="kw">list</span>(generator<span class="op">$</span><span class="kw">getDecl</span>(<span class="dv">1</span>)<span class="op">$</span><span class="kw">getId</span>())),</span>
<span id="cb53-4"><a href="#cb53-4"></a>                                                             <span class="dt">binop =</span> <span class="st">&quot;&gt;=&quot;</span>, <span class="dt">rhs =</span> Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">0</span>))</span>
<span id="cb53-5"><a href="#cb53-5"></a></span>
<span id="cb53-6"><a href="#cb53-6"></a>comprehension =<span class="st"> </span>Comprehension<span class="op">$</span><span class="kw">new</span>(<span class="dt">generators =</span> <span class="kw">list</span>(generator), <span class="dt">body =</span> bop, <span class="dt">set =</span> <span class="ot">FALSE</span>)</span>
<span id="cb53-7"><a href="#cb53-7"></a>comprehension<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;[(a[i] &gt;= 0) | i in a ]&quot;</code></pre>
</div>
<div id="call" class="section level3">
<h3>Call</h3>
<p>Read more about call <a href="https://www.minizinc.org/doc-2.4.3/en/spec.html#call-expressions">here</a>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>cl =<span class="st"> </span>Call<span class="op">$</span><span class="kw">new</span>(<span class="dt">fnName =</span> <span class="st">&quot;forall&quot;</span>, <span class="dt">args =</span> <span class="kw">list</span>(comprehension))</span>
<span id="cb55-2"><a href="#cb55-2"></a>cl<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;forall([(a[i] &gt;= 0) | i in a ])&quot;</code></pre>
</div>
<div id="if-then-else" class="section level3">
<h3>If Then Else</h3>
<p>Read more about if-then-else expressions <a href="https://www.minizinc.org/doc-2.4.3/en/spec.html#if-then-else-expressions">here</a>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># if x &lt; 0 then -1 elseif x &gt; 0 then 1 else 0 endif</span></span>
<span id="cb57-2"><a href="#cb57-2"></a></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="co"># var int:x;</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>x =<span class="st"> </span><span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;var&quot;</span>)</span>
<span id="cb57-5"><a href="#cb57-5"></a>x<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;var int: x&quot;</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>bop1 =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> x<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">binop =</span> <span class="st">&quot;&lt;&quot;</span>, <span class="dt">rhs =</span> Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">0</span>))</span>
<span id="cb59-2"><a href="#cb59-2"></a>bop1<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;(x &lt; 0)&quot;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>uop =<span class="st"> </span>UnOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">args =</span> <span class="kw">c</span>(Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">1</span>)), <span class="dt">op =</span> <span class="st">&quot;-&quot;</span>)</span>
<span id="cb61-2"><a href="#cb61-2"></a>uop<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;-(1)&quot;</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>bop2 =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> x<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">binop =</span> <span class="st">&quot;&lt;&quot;</span>, <span class="dt">rhs =</span> Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">0</span>))</span>
<span id="cb63-2"><a href="#cb63-2"></a>bop2<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;(x &lt; 0)&quot;</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>exp =<span class="st"> </span>Ite<span class="op">$</span><span class="kw">new</span>(<span class="dt">ifs =</span> <span class="kw">c</span>(bop1, bop2), <span class="dt">thens =</span> <span class="kw">c</span>(uop, Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">1</span>)), <span class="dt">Else =</span> Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">0</span>))</span>
<span id="cb65-2"><a href="#cb65-2"></a>exp<span class="op">$</span><span class="kw">c_str</span>()</span></code></pre></div>
<pre><code>## [1] &quot;if ((x &lt; 0)) then (-(1)) elseif ((x &lt; 0)) then (1) else (0) endif&quot;</code></pre>
</div>
<div id="let" class="section level3">
<h3>Let</h3>
<p>Read more about let expressions <a href="https://www.minizinc.org/doc-2.4.3/en/spec.html#spec-let-expressions">here</a>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># let { int: x = 3; int: y = 4; } in x + y</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>x =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, <span class="dt">value =</span> <span class="dv">3</span>))</span>
<span id="cb67-3"><a href="#cb67-3"></a>y =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, <span class="dt">value =</span> <span class="dv">4</span>))</span>
<span id="cb67-4"><a href="#cb67-4"></a>bop =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> x<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">binop =</span> <span class="st">&quot;+&quot;</span>, <span class="dt">rhs =</span> y<span class="op">$</span><span class="kw">getId</span>())</span>
<span id="cb67-5"><a href="#cb67-5"></a>let =<span class="st"> </span>Let<span class="op">$</span><span class="kw">new</span>(<span class="dt">let =</span> <span class="kw">c</span>(x,y), <span class="dt">body =</span> bop)</span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="kw">cat</span>(let<span class="op">$</span><span class="kw">c_str</span>())</span></code></pre></div>
<pre><code>## let {int: x = 3;
## int: y = 4;
## } in (x + y)</code></pre>
</div>
</div>
<div id="create-items-using-strings" class="section level2">
<h2>Create Items Using Strings</h2>
<p>The strings containing MiniZinc syntax of items can be directly supplied to the constructors to initialize the objects. If strings are supplied, no other argument should be supplied to any of the Item classes except for <code>AssignItem</code> where you need to provided the associated variable declaration for the assignment.</p>
<div id="varaible-item" class="section level3">
<h3>Varaible Item</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>declItem =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">mzn_str =</span> <span class="st">&quot;set of int: WORKSHEET = 0..worksheets-1;&quot;</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="kw">sprintf</span>(<span class="st">&quot;Is this a parameter? %s&quot;</span>, declItem<span class="op">$</span><span class="kw">getDecl</span>()<span class="op">$</span><span class="kw">isPar</span>())</span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="kw">sprintf</span>(<span class="st">&quot;Is this a set? %s&quot;</span>, declItem<span class="op">$</span><span class="kw">getDecl</span>()<span class="op">$</span><span class="kw">ti</span>()<span class="op">$</span><span class="kw">type</span>()<span class="op">$</span><span class="kw">isSet</span>())</span>
<span id="cb69-4"><a href="#cb69-4"></a><span class="kw">sprintf</span>(<span class="st">&quot;Base type of set: %s&quot;</span>, declItem<span class="op">$</span><span class="kw">getDecl</span>()<span class="op">$</span><span class="kw">ti</span>()<span class="op">$</span><span class="kw">type</span>()<span class="op">$</span><span class="kw">bt</span>())</span>
<span id="cb69-5"><a href="#cb69-5"></a><span class="kw">sprintf</span>(<span class="st">&quot;Name: %s&quot;</span>, declItem<span class="op">$</span><span class="kw">getId</span>()<span class="op">$</span><span class="kw">getName</span>())</span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="kw">sprintf</span>(<span class="st">&quot;Value: %s&quot;</span>, declItem<span class="op">$</span><span class="kw">getDecl</span>()<span class="op">$</span><span class="kw">getValue</span>()<span class="op">$</span><span class="kw">c_str</span>())</span></code></pre></div>
<pre><code>## [1] &quot;Is this a parameter? TRUE&quot;
## [1] &quot;Is this a set? TRUE&quot;
## [1] &quot;Base type of set: int&quot;
## [1] &quot;Name: WORKSHEET&quot;
## [1] &quot;Value: (0 .. (worksheets - 1))&quot;</code></pre>
</div>
<div id="constraint-item" class="section level3">
<h3>Constraint Item</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>CstrItem =<span class="st"> </span>ConstraintItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">mzn_str =</span> <span class="st">&quot;constraint forall (i in PREC)</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="st">                  (let { WORKSHEET: w1 = preceeds[i];</span></span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="st">                             WORKSHEET: w2 = succeeds[i]; } in</span></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="st">                   g[w1] * e[w1] &lt;= d[w2] + days * (1 - g[w2]));&quot;</span>)</span>
<span id="cb71-5"><a href="#cb71-5"></a><span class="kw">sprintf</span>(<span class="st">&quot;Expression involved: %s&quot;</span>, CstrItem<span class="op">$</span><span class="kw">getExp</span>()<span class="op">$</span><span class="kw">c_str</span>())</span>
<span id="cb71-6"><a href="#cb71-6"></a><span class="kw">sprintf</span>(<span class="st">&quot;Call function name: %s&quot;</span>, CstrItem<span class="op">$</span><span class="kw">getExp</span>()<span class="op">$</span><span class="kw">getName</span>())</span>
<span id="cb71-7"><a href="#cb71-7"></a><span class="kw">sprintf</span>(<span class="st">&quot;Number of Arguments: %s&quot;</span>, CstrItem<span class="op">$</span><span class="kw">getExp</span>()<span class="op">$</span><span class="kw">nargs</span>())</span>
<span id="cb71-8"><a href="#cb71-8"></a><span class="kw">sprintf</span>(<span class="st">&quot;Class of Argument: %s&quot;</span>,  <span class="kw">class</span>(CstrItem<span class="op">$</span><span class="kw">getExp</span>()<span class="op">$</span><span class="kw">getArg</span>(<span class="dv">1</span>))[<span class="dv">1</span>])</span>
<span id="cb71-9"><a href="#cb71-9"></a><span class="kw">sprintf</span>(<span class="st">&quot;Number of Generators: %s&quot;</span>, CstrItem<span class="op">$</span><span class="kw">getExp</span>()<span class="op">$</span><span class="kw">nargs</span>())</span>
<span id="cb71-10"><a href="#cb71-10"></a><span class="kw">sprintf</span>(<span class="st">&quot;Generator: %s&quot;</span>, CstrItem<span class="op">$</span><span class="kw">getExp</span>()<span class="op">$</span><span class="kw">getArg</span>(<span class="dv">1</span>)<span class="op">$</span><span class="kw">getGen</span>(<span class="dv">1</span>)<span class="op">$</span><span class="kw">c_str</span>())</span>
<span id="cb71-11"><a href="#cb71-11"></a><span class="kw">sprintf</span>(<span class="st">&quot;Comprehension body: %s&quot;</span>, CstrItem<span class="op">$</span><span class="kw">getExp</span>()<span class="op">$</span><span class="kw">getArg</span>(<span class="dv">1</span>)<span class="op">$</span><span class="kw">getBody</span>()<span class="op">$</span><span class="kw">c_str</span>())</span></code></pre></div>
<pre><code>## [1] &quot;Expression involved: forall([let {WORKSHEET: w1 = preceeds[i];\nWORKSHEET: w2 = succeeds[i];\n} in ((g[w1] * e[w1]) &lt;= (d[w2] + (days * (1 - g[w2])))) | i in PREC ])&quot;
## [1] &quot;Call function name: forall&quot;
## [1] &quot;Number of Arguments: 1&quot;
## [1] &quot;Class of Argument: Comprehension&quot;
## [1] &quot;Number of Generators: 1&quot;
## [1] &quot;Generator: i in PREC &quot;
## [1] &quot;Comprehension body: let {WORKSHEET: w1 = preceeds[i];\nWORKSHEET: w2 = succeeds[i];\n} in ((g[w1] * e[w1]) &lt;= (d[w2] + (days * (1 - g[w2]))))&quot;</code></pre>
</div>
<div id="solve-item" class="section level3">
<h3>Solve Item</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>SlvItem =<span class="st"> </span>SolveItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">mzn_str =</span> <span class="st">&quot;solve </span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="st">    :: int_search(</span></span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="st">        [ if j = 1 then g[import_first[i]] else -d[import_first[i]] endif  | i in 1..worksheets, j in 1..2], </span></span>
<span id="cb73-4"><a href="#cb73-4"></a><span class="st">        input_order, indomain_max, complete)</span></span>
<span id="cb73-5"><a href="#cb73-5"></a><span class="st">    maximize objective;&quot;</span>)</span>
<span id="cb73-6"><a href="#cb73-6"></a><span class="kw">sprintf</span>(<span class="st">&quot;Objective: %s&quot;</span>, SlvItem<span class="op">$</span><span class="kw">getSt</span>())</span>
<span id="cb73-7"><a href="#cb73-7"></a><span class="kw">cat</span>(<span class="kw">sprintf</span>(<span class="st">&quot;Annotation: %s&quot;</span>, SlvItem<span class="op">$</span><span class="kw">getAnn</span>()<span class="op">$</span><span class="kw">c_str</span>()))</span></code></pre></div>
<pre><code>## [1] &quot;Objective: maximize&quot;
## Annotation:  :: int_search([if ((j = 1)) then (g[import_first[i]]) else (-(d[import_first[i]])) endif | i in (1 .. worksheets) , j in 1..2 ], input_order, indomain_max, complete)</code></pre>
</div>
<div id="function-item" class="section level3">
<h3>Function Item</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>fnItem =<span class="st"> </span>FunctionItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">mzn_str =</span> <span class="st">&quot;predicate nonoverlap(var int:s1, var int:d1,</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="st">                     var int:s2, var int:d2)=</span></span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="st">          s1 + d1 &lt;= s2 </span><span class="ch">\\</span><span class="st">/ s2 + d2 &lt;= s1;&quot;</span>)</span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="kw">sprintf</span>(<span class="st">&quot;Function name: %s&quot;</span>, fnItem<span class="op">$</span><span class="kw">name</span>())</span>
<span id="cb75-5"><a href="#cb75-5"></a><span class="kw">sprintf</span>(<span class="st">&quot;No of function declarations: %s&quot;</span>, <span class="kw">length</span>(fnItem<span class="op">$</span><span class="kw">getDecls</span>()))</span>
<span id="cb75-6"><a href="#cb75-6"></a><span class="kw">sprintf</span>(<span class="st">&quot;Function expression: %s&quot;</span>, fnItem<span class="op">$</span><span class="kw">getBody</span>()<span class="op">$</span><span class="kw">c_str</span>())</span></code></pre></div>
<pre><code>## [1] &quot;Function name: nonoverlap&quot;
## [1] &quot;No of function declarations: 4&quot;
## [1] &quot;Function expression: (((s1 + d1) &lt;= s2) \\/ ((s2 + d2) &lt;= s1))&quot;</code></pre>
</div>
<div id="include-item" class="section level3">
<h3>Include Item</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>iItem =<span class="st"> </span>IncludeItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">mzn_str =</span> <span class="st">&quot;include </span><span class="ch">\&quot;</span><span class="st">cumulative.mzn</span><span class="ch">\&quot;</span><span class="st"> ;&quot;</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="kw">sprintf</span>(<span class="st">&quot;Included mzn name: %s&quot;</span>, iItem<span class="op">$</span><span class="kw">getmznName</span>())</span></code></pre></div>
<pre><code>## [1] &quot;Included mzn name: solver_redefinitions.mzn&quot;</code></pre>
</div>
</div>
<div id="create-a-model-from-scratch" class="section level2">
<h2>Create a Model from Scratch</h2>
<p>Let’s compute the base of a right angled triangle given the height and hypotenuse. The Pythagoras theorem says that In a right-angled triangle, the square of the hypotenuse side is equal to the sum of squares of the other two sides i.e <span class="math inline">\(a² + b² = c²\)</span>. The theorem give us three functions, <span class="math inline">\(c = \sqrt{(a² + b²)}\)</span>, <span class="math inline">\(a = \sqrt(c² - b²)\)</span> and <span class="math inline">\(b = \sqrt(c² - a²)\)</span>.</p>
<p>MiniZinc Representation of the model:</p>
<pre><code>int: a = 4;
int: c = 5;
var int: b;

constraint b&gt;0;
constraint a² + b² = c²;

solve satisfy;</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>a =<span class="st"> </span><span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, <span class="dt">value =</span> <span class="dv">4</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a>c =<span class="st"> </span><span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;c&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;par&quot;</span>, <span class="dt">value =</span> <span class="dv">5</span>)</span>
<span id="cb80-3"><a href="#cb80-3"></a>b =<span class="st"> </span><span class="kw">IntDecl</span>(<span class="dt">name =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">kind =</span> <span class="st">&quot;var&quot;</span>)</span>
<span id="cb80-4"><a href="#cb80-4"></a></span>
<span id="cb80-5"><a href="#cb80-5"></a><span class="co"># declaration items</span></span>
<span id="cb80-6"><a href="#cb80-6"></a>a_item =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> a)</span>
<span id="cb80-7"><a href="#cb80-7"></a>b_item =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> b)</span>
<span id="cb80-8"><a href="#cb80-8"></a>c_item =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">decl =</span> c)</span>
<span id="cb80-9"><a href="#cb80-9"></a></span>
<span id="cb80-10"><a href="#cb80-10"></a><span class="co"># b &gt; 0 is a binary operation</span></span>
<span id="cb80-11"><a href="#cb80-11"></a>b_<span class="dv">0</span> =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> b<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">binop =</span> <span class="st">&quot;&gt;&quot;</span>, <span class="dt">rhs =</span> Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">0</span>))</span>
<span id="cb80-12"><a href="#cb80-12"></a>constraint1  =<span class="st"> </span>ConstraintItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">e =</span> b_<span class="dv">0</span>)</span>
<span id="cb80-13"><a href="#cb80-13"></a></span>
<span id="cb80-14"><a href="#cb80-14"></a><span class="co"># a ^ 2 is a binary operation</span></span>
<span id="cb80-15"><a href="#cb80-15"></a><span class="co"># a$getId() gives the variable identifier</span></span>
<span id="cb80-16"><a href="#cb80-16"></a>a_<span class="dv">2</span> =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> a<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">binop =</span> <span class="st">&quot;^&quot;</span>, Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">2</span>))</span>
<span id="cb80-17"><a href="#cb80-17"></a>b_<span class="dv">2</span> =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> b<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">binop =</span> <span class="st">&quot;^&quot;</span>, Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">2</span>))</span>
<span id="cb80-18"><a href="#cb80-18"></a>a2_b2 =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> a_<span class="dv">2</span>, <span class="dt">binop =</span> <span class="st">&quot;+&quot;</span>, <span class="dt">rhs =</span> b_<span class="dv">2</span>)</span>
<span id="cb80-19"><a href="#cb80-19"></a>c_<span class="dv">2</span> =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> c<span class="op">$</span><span class="kw">getId</span>(), <span class="dt">binop =</span> <span class="st">&quot;^&quot;</span>, Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">2</span>))</span>
<span id="cb80-20"><a href="#cb80-20"></a>a2_b2_c2 =<span class="st"> </span>BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> a2_b2, <span class="dt">binop =</span> <span class="st">&quot;=&quot;</span>, <span class="dt">rhs =</span> c_<span class="dv">2</span>)</span>
<span id="cb80-21"><a href="#cb80-21"></a>constraint2  =<span class="st"> </span>ConstraintItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">e =</span> a2_b2_c2)</span>
<span id="cb80-22"><a href="#cb80-22"></a></span>
<span id="cb80-23"><a href="#cb80-23"></a>solve  =<span class="st"> </span>SolveItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">solve_type =</span> <span class="st">&quot;satisfy&quot;</span>)</span>
<span id="cb80-24"><a href="#cb80-24"></a></span>
<span id="cb80-25"><a href="#cb80-25"></a>model =<span class="st"> </span>Model<span class="op">$</span><span class="kw">new</span>(<span class="dt">items =</span> <span class="kw">c</span>(a_item, b_item, c_item, constraint1, constraint2, solve))</span>
<span id="cb80-26"><a href="#cb80-26"></a></span>
<span id="cb80-27"><a href="#cb80-27"></a><span class="kw">cat</span>(model<span class="op">$</span><span class="kw">mzn_string</span>())</span></code></pre></div>
<pre><code>## int: a = 4;
## 
## var int: b;
## 
## int: c = 5;
## 
## constraint (b &gt; 0);
## 
## constraint (((a ^ 2) + (b ^ 2)) = (c ^ 2));
## 
## solve  satisfy;</code></pre>
</div>
<div id="delete-items-and-expressions" class="section level2">
<h2>Delete Items and Expressions</h2>
<p>All the <code>Item</code> and <code>Expression</code> classes have a <code>delete()</code> function which is used to delete the objects from everywhere in the model. Note that the objects will be deleted from all the models present in the environment from where the <code>delete()</code> function is called. An example to demonstrate the same is shown below:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># delete the item a i.e declaration of a </span></span>
<span id="cb82-2"><a href="#cb82-2"></a>a<span class="op">$</span><span class="kw">delete</span>()</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="kw">cat</span>(model<span class="op">$</span><span class="kw">mzn_string</span>())</span></code></pre></div>
<pre><code>## var int: b;
## 
## int: c = 5;
## 
## constraint (b &gt; 0);
## 
## constraint (((a ^ 2) + (b ^ 2)) = (c ^ 2));
## 
## solve  satisfy;</code></pre>
</div>
<div id="modify-variable-domain" class="section level2">
<h2>Modify Variable Domain</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>vd =<span class="st"> </span><span class="kw">VarDomainDecl</span>(<span class="dt">name =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">dom =</span> Set<span class="op">$</span><span class="kw">new</span>(IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dt">imin =</span> <span class="dv">1</span>, <span class="dt">imax =</span> <span class="dv">2</span>)))</span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="kw">sprintf</span>(<span class="st">&quot;The current declaration is: %s&quot;</span>, vd<span class="op">$</span><span class="kw">c_str</span>())</span>
<span id="cb84-3"><a href="#cb84-3"></a>vd<span class="op">$</span><span class="kw">setDomain</span>(Set<span class="op">$</span><span class="kw">new</span>(IntSetVal<span class="op">$</span><span class="kw">new</span>(<span class="dt">imin =</span> <span class="dv">3</span>, <span class="dt">imax =</span> <span class="dv">5</span>)))</span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="kw">sprintf</span>(<span class="st">&quot;The modified declaration is: %s&quot;</span>, vd<span class="op">$</span><span class="kw">c_str</span>())</span></code></pre></div>
<pre><code>## [1] &quot;The current declaration is: var 1..2: n&quot;
## [1] &quot;The modified declaration is: var 3..5: n&quot;</code></pre>
</div>
<div id="modify-constraints" class="section level2">
<h2>Modify Constraints</h2>
<p>There are various getter and setter functions for the expression classes that can be used to modify existing constraints. For example:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>vItem =<span class="st"> </span>VarDeclItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">mzn_str =</span> <span class="st">&quot;set of int: a = {1, 2, 3, 4};&quot;</span>) </span>
<span id="cb86-2"><a href="#cb86-2"></a>cItem =<span class="st"> </span>ConstraintItem<span class="op">$</span><span class="kw">new</span>(<span class="dt">mzn_str =</span> <span class="st">&quot;constraint sum(a) &lt; 10;&quot;</span>)</span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="kw">sprintf</span>(<span class="st">&quot;The current constraint is: %s&quot;</span>, cItem<span class="op">$</span><span class="kw">c_str</span>())</span>
<span id="cb86-4"><a href="#cb86-4"></a>cItem<span class="op">$</span><span class="kw">setExp</span>(BinOp<span class="op">$</span><span class="kw">new</span>(<span class="dt">lhs =</span> Call<span class="op">$</span><span class="kw">new</span>(<span class="dt">fnName =</span> <span class="st">&quot;max&quot;</span>, <span class="dt">args =</span> <span class="kw">list</span>(vItem<span class="op">$</span><span class="kw">getDecl</span>()<span class="op">$</span><span class="kw">getId</span>())),</span>
<span id="cb86-5"><a href="#cb86-5"></a>                       <span class="dt">binop =</span> <span class="st">&quot;&lt;&quot;</span>, <span class="dt">rhs =</span> Int<span class="op">$</span><span class="kw">new</span>(<span class="dv">10</span>)))</span>
<span id="cb86-6"><a href="#cb86-6"></a><span class="kw">sprintf</span>(<span class="st">&quot;The modified constraint is: %s&quot;</span>, cItem<span class="op">$</span><span class="kw">c_str</span>())</span></code></pre></div>
<pre><code>## [1] &quot;The current constraint is: constraint (sum(a) &lt; 10);\n&quot;
## [1] &quot;The modified constraint is: constraint (max(a) &lt; 10);\n&quot;</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
